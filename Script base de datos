create table Paises(
id_pais int not null,
nombre_pais varchar(50),
constraint pk_pais primary key(id_pais)
);

insert into Paises(id_pais,nombre_pais)
values(1,'Costa rica');

------------------------------
create table Direccion(
id_direccion int not null,
id_pais int not null,
direccion_domicilio varchar2(50) not null,
constraint pk_direccion primary key(id_direccion),
constraint fk_pais foreign key (id_pais) references Paises(id_pais)
);

insert into Direccion(id_direccion,id_pais,direccion_domicilio)
values(1,1,'San Jose, la uruca');

insert into Direccion(id_direccion,id_pais,direccion_domicilio)
values(2,1,'San Jose, sabana');

select * from direccion;
------------------------------
create table Cliente(
id_cliente int not null,
nombre_cliente varchar(50) not null,
correo_cliente varchar(50) not null,
telefono_cliente int not null,
id_direccion int not null,
constraint pk_cliente primary key (id_cliente),
constraint fk_direccion foreign key (id_direccion) references Direccion(id_direccion)
);

insert into Cliente(id_cliente,nombre_cliente,correo_cliente,telefono_cliente,id_direccion)
values(1,'Carlos','carlos@gmail.com',70594020,1);

insert into Cliente(id_cliente,nombre_cliente,correo_cliente,telefono_cliente,id_direccion)
values(2,'Andres','Andres@gmail.com',90392313,2);


------------------------------
create table Aerolinea(
id_aerolinea int not null,
nombre_aerolinea varchar(50),
telefono_aerolinea int,
correo_aerolinea varchar(50),
constraint pk_aerolinea primary key (id_aerolinea)
);

insert into Aerolinea(id_aerolinea,nombre_aerolinea,telefono_aerolinea,correo_aerolinea)
values(1,'AmericaVuela',20201932,'america@vuela.com');
------------------------------
create table Avion(
id_avion int not null,
id_aerolinea int not null,
modelo_avion varchar(50) not null,
capacidad_pasajeros int not null,
constraint pk_avion primary key (id_avion),
constraint fk_aerolinea foreign key (id_aerolinea) references Aerolinea(id_aerolinea)
);

insert into Avion(id_avion,id_aerolinea,modelo_avion,capacidad_pasajeros)
values(1,1,'A320',250);
------------------------------
create table Destino(
id_destino int not null,
nombre_destino varchar(50) not null,
constraint pk_destino primary key (id_destino)
);

insert into Destino(id_destino,nombre_destino)
values(57,'Aeropueto Internacional El Dorado Colombia');
------------------------------
create table Origen(
id_origen int not null,
nombre_origen varchar(50) not null,
constraint pk_origen primary key (id_origen)
);

insert into Origen(id_origen,nombre_origen)
values(506,'Aeropueto Internacional Juan Santamaria');
------------------------------
create table tipo_de_asiento(
id_tipo int not null,
nombre_tipo_asiento varchar(50) not null,
constraint pk_tipo_asiento primary key(id_tipo)
);

insert into tipo_de_asiento(id_tipo,nombre_tipo_asiento)
values(20,'asiento de clase economica');
------------------------------
create table Vuelos(
id_vuelo int not null,
nombre_vuelo varchar(50) not null,
id_origen int not null,
id_destino int not null,
id_avion int not null,
id_tipo_asiento int not null,
fecha_salida date not null,
fecha_llegada date not null,
precio_economico number(10,2),
precio_negocios number(10,2),
precio_primera_clase number(10,2),
constraint pk_vuelos primary key (id_vuelo),
constraint fk_origen foreign key (id_origen) references Origen(id_origen),
constraint fk_destino foreign key (id_destino) references Destino(id_destino),
constraint fk_avion foreign key (id_avion) references Avion(id_avion),
constraint fk_tipo_asiento foreign key (id_tipo_asiento) references tipo_de_asiento(id_tipo)
);


insert into Vuelos(id_vuelo,nombre_vuelo,id_origen,id_destino,id_avion,id_tipo_asiento,fecha_salida,fecha_llegada,precio_economico,precio_negocios,precio_primera_clase)
values(1018,'CR-CO',506,57,1,20,to_date('01/04/2023 09:30' , 'dd-mm-yyyy hh:mi'),to_date('01/04/2023 12:50' , 'dd-mm-yyyy hh:mi'),100.00,200.00,1000.00);

------------------------------

CREATE TABLE comprar_reservas(
    id_compras_reservas NUMBER(10) PRIMARY KEY,
    cliente_id NUMBER(10) REFERENCES cliente(id_cliente),
    vuelo_id NUMBER(10) REFERENCES vuelos(id_vuelo),
    fecha_compra DATE,
    precio_total NUMBER(10,2),
    asientos_reservados VARCHAR2(100)
);

insert into comprar_reservas(ID_COMPRAS_RESERVAS,CLIENTE_ID,vuelo_id,fecha_compra,precio_total,asientos_reservados)
values(1,1,1018,sysdate,100.00,'1');

select * from COMPRAR_RESERVAS;

------------------------------

CREATE VIEW v_clientes_direcciones_paises AS 
SELECT c.nombre_cliente, c.correo_cliente, c.telefono_cliente, d.direccion_domicilio, p.nombre_pais 
FROM Cliente c 
JOIN Direccion d ON c.id_direccion = d.id_direccion 
JOIN Paises p ON d.id_pais = p.id_pais;

select * from v_clientes_direcciones_paises;

----------------------------
CREATE VIEW v_aerolineas_aviones AS 
SELECT a.nombre_aerolinea, a.telefono_aerolinea, a.correo_aerolinea, av.modelo_avion, av.capacidad_pasajeros 
FROM Aerolinea a 
JOIN Avion av ON a.id_aerolinea = av.id_aerolinea;

select * from v_aerolineas_aviones;

------------------

CREATE VIEW v_vuelos_precios AS 
SELECT v.nombre_vuelo, o.nombre_origen, d.nombre_destino, v.fecha_salida, v.fecha_llegada, 
    v.precio_economico, v.precio_negocios, v.precio_primera_clase 
FROM Vuelos v 
JOIN Origen o ON v.id_origen = o.id_origen 
JOIN Destino d ON v.id_destino = d.id_destino;

select * from v_vuelos_precios;

-------------------

CREATE VIEW v_reservas_clientes_vuelos AS 
SELECT cr.id_compras_reservas, c.nombre_cliente, c.correo_cliente, v.nombre_vuelo, 
    cr.fecha_compra, cr.precio_total, cr.asientos_reservados 
FROM comprar_reservas cr 
JOIN Cliente c ON cr.cliente_id = c.id_cliente 
JOIN Vuelos v ON cr.vuelo_id = v.id_vuelo;

select * from V_RESERVAS_CLIENTES_VUELOS;

---------------------------
CREATE VIEW v_vuelos_completos AS 
SELECT v.nombre_vuelo, o.nombre_origen, d.nombre_destino, a.nombre_aerolinea, 
    av.modelo_avion, av.capacidad_pasajeros, v.fecha_salida, v.fecha_llegada, 
    v.precio_economico, v.precio_negocios, v.precio_primera_clase 
FROM Vuelos v 
JOIN Origen o ON v.id_origen = o.id_origen 
JOIN Destino d ON v.id_destino = d.id_destino 
JOIN Avion av ON v.id_avion = av.id_avion 
JOIN Aerolinea a ON av.id_aerolinea = a.id_aerolinea;

select * from v_vuelos_completos;

----------------------
